C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: F:\Keil\C51\BIN\C51.EXE ..\user\main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings
                    -\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          
   2          #define ALLOCATE_EXTERN
   3          #include "HC89F0541.h"
   4          
   5          
   6          #define PIN2 P3_5
   7          #define PIN3 P3_4
   8          #define PIN4 P2_4
   9          #define PIN5 P2_3
  10          #define PIN6 P2_2
  11          #define PIN7 P2_1
  12          #define PIN8 P2_0
  13          #define PIN9 P1_7
  14          #define PIN10 P1_6
  15          #define PIN11 P1_5
  16          #define PIN12 P1_4
  17          #define PIN13 P1_3
  18          #define PIN14 P1_2
  19          #define PIN15 P1_1
  20          #define PIN16 P1_0
  21          #define PIN17 P0_7
  22          #define PIN18 P0_6
  23          #define PIN19 P0_5
  24          #define PIN20 P0_4
  25          #define PIN21 P0_3
  26          #define PIN22 P0_2
  27          #define PIN23 P0_1
  28          #define PIN24 P0_0
  29          #define PIN25 P2_7
  30          #define PIN26 P2_6
  31          #define PIN27 P2_5
  32          
  33          #define C_PIN2 P3M5
  34          #define C_PIN3 P3M4
  35          #define C_PIN4 P2M4
  36          #define C_PIN5 P2M3
  37          #define C_PIN6 P2M2
  38          #define C_PIN7 P2M1
  39          #define C_PIN8 P2M0
  40          #define C_PIN9 P1M7
  41          #define C_PIN10 P1M6
  42          #define C_PIN11 P1M5
  43          #define C_PIN12 P1M4
  44          #define C_PIN13 P1M3
  45          #define C_PIN14 P1M2
  46          #define C_PIN15 P1M1
  47          #define C_PIN16 P1M0
  48          #define C_PIN17 P0M7
  49          #define C_PIN18 P0M6
  50          #define C_PIN19 P0M5
  51          #define C_PIN20 P0M4
  52          #define C_PIN21 P0M3
  53          #define C_PIN22 P0M2
  54          #define C_PIN23 P0M1
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 2   

  55          #define C_PIN24 P0M0
  56          #define C_PIN25 P2M7
  57          #define C_PIN26 P2M6
  58          #define C_PIN27 P2M5
  59          
  60          #define RLY PIN3
  61          #define KG PIN4
  62          #define BUZ PIN2
  63          #define C_RLY C_PIN3
  64          #define C_KG C_PIN4
  65          #define C_BUZ C_PIN2
  66          
  67          #define OD_OUTPUT 0xC4
  68          #define PP_OUTPUT 0xC0
  69          #define IN_INPUT 0x60
  70          #define SS_INPUT 0x5B
  71          #define AN_INPUT 0x00
  72          
  73          #define DISPLAY_A  PIN20
  74          #define DISPLAY_B  PIN24
  75          #define DISPLAY_C  PIN15
  76          #define DISPLAY_D  PIN17
  77          #define DISPLAY_E  PIN18
  78          #define DISPLAY_F  PIN21
  79          #define DISPLAY_G  PIN9
  80          #define DISPLAY_DP PIN16
  81          
  82          #define S1 PIN20
  83          #define S2 PIN20
  84          #define S3 PIN18
  85          #define S4 PIN18
  86          #define S5 PIN17
  87          #define S6 PIN17
  88          #define S7 PIN24
  89          #define S8 PIN21
  90          #define S9 PIN21
  91          #define S10 PIN26
  92          #define S11 PIN26
  93          #define S12 PIN25
  94          #define S13 PIN16
  95          #define S14 PIN9
  96          #define S15 PIN16
  97          #define S16 PIN9
  98          #define S17 PIN15
  99          #define S18 PIN15
 100          #define S19 PIN24
 101          
 102          xdata char g_din_wen_peng_ren_led=0;
 103          xdata char g_dun_rou_led=0;
 104          xdata char g_dun_tang_led=0;
 105          xdata char g_lao_huo_man_dun_led=0;
 106          xdata char g_jian_kang_zheng_led=0;
 107          xdata char g_jian_cao_led=0;
 108          xdata char g_suan_nao_led=0;
 109          xdata char g_fa_jiao_led=0;
 110          xdata char g_xiao_du_led=0;
 111          xdata char g_dan_gao_led=0;
 112          xdata char g_feng_pei_led=0;
 113          xdata char g_ji_ya_led=0;
 114          xdata char g_mi_fan_led=0;
 115          xdata char g_dou_lei_led=0;
 116          xdata char g_zha_liang_led=0;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 3   

 117          xdata char g_yan_mai_led=0;
 118          xdata char g_ji_dan_led=0;
 119          xdata char g_bao_wen_led=0;
 120          xdata char g_chang_duan_led[3]={0};
 121          xdata char g_shu_ma_guan[4];
 122          xdata char g_L_led=0;
 123          xdata char g_P_led=0;
 124          xdata char g_shi_jian_liang_dian=0;
 125          xdata char g_key_code=0;
 126          
 127          
 128          xdata enum WORK_MODE{
 129            STOP=0,
 130            DIN_WEN_PENG_REN,
 131            DUN_ROU,
 132            DUN_TANG,
 133            LAO_HUO_MAN_DUN,
 134            JIAN_KANG_ZHENG,
 135            JIAN_CAO,
 136            MI_FAN,
 137            DOU_LEI,
 138            ZHA_LIANG,
 139            YAN_MAI,
 140            JI_DAN,
 141            SUAN_NAO,
 142            FA_JIAO,
 143            XIAO_DU,
 144            DAN_GAO,
 145            FENG_PEI,
 146            JI_YA,
 147            BAO_WEN
 148          
 149          };
 150          xdata unsigned  short g_default_time[]={0,240,30,25,240,10,15,12,35,20,5,15,600,180,2,48,30,13,24*60};
 151           unsigned short g_peng_ren_shi_chang=0;
 152           unsigned char g_peng_ren_wen_du=0;
 153           unsigned char g_ya_li_kai_guan=0;
 154           unsigned char g_work_mode=0;
 155           unsigned char g_work_start=0;
 156           unsigned short g_work_counter=0;
 157           unsigned short g_yu_yue_shi_jian=0;
 158           unsigned short g_operate_counter=0;
 159           unsigned char g_kid_lock=0;
 160          
 161           unsigned char g_xiao_peng_ren_shi_jian=0;
 162           unsigned char g_seting_wen_du=0;
 163           unsigned short g_working_counter=0;
 164           unsigned char g_err_code=0;
 165           unsigned char g_dai_P=0;
 166           unsigned char g_dai_no_P=0;
 167           unsigned char g_peng_ren_chang_duan_shi_jian=0;
 168           unsigned char g_P_bao_ya_counter_start=0;
 169           unsigned char g_peng_ren_over=0;
 170           unsigned char g_hoting=0;
 171           u16 g_currnet_temp=0;
 172           u32 g_RLY_work_time=0;
 173           unsigned char g_yu_yue_ing=0;
 174           u32 g_stop_counter=0;
 175          
 176          char g_fun_index1=0;
 177          char g_fun_index2=0;
 178          void Delay_1us(unsigned int n)     
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 4   

 179          {
 180   1        unsigned char i;
 181   1      
 182   1        for(i=0;i<3;i++);
 183   1      
 184   1      }
*** WARNING C280 IN LINE 178 OF ..\user\main.c: 'n': unreferenced local variable
 185          void Delay_50us(unsigned int n)    
 186          {
 187   1        unsigned char i;
 188   1        while(n--)
 189   1        {
 190   2          for(i=0;i<71;i++);
 191   2        }
 192   1      }
 193          void Delay_ms(unsigned int delay_nms)
 194          {
 195   1        while(delay_nms--)
 196   1        {
 197   2          Delay_50us(20);
 198   2        }
 199   1      }
 200          void init_uart1()
 201          {
 202   1        P1M5 = 0xC2;                //P16ÉèÖÃÎªÍÆÍìÊä³ö
 203   1        TXD_MAP = 0x15;           //TXDÓ³ÉäP16  
 204   1        T4CON = 0x06;           //T4¹¤×÷Ä£Ê½£ºUART1²¨ÌØÂÊ·¢ÉúÆ÷
 205   1          
 206   1          TH4 = 0xFF;
 207   1        TL4 = 0x98;             //²¨ÌØÂÊ9600
 208   1        SCON2 = 0x02;           //8Î»UART£¬²¨ÌØÂÊ¿É±ä
 209   1      }
 210          void putchar(char c)
 211          {
 212   1        SBUF = c;//·¢ËÍ8Î»´®¿ÚÊý¾Ý
 213   1        while(!(SCON & 0x02));
 214   1        SCON &=~ 0x02;      //Çå³ý·¢ËÍÖÐ¶Ï±êÖ¾Î»
 215   1      }
 216          
 217          void init_timer0() //1ms
 218          {
 219   1      
 220   1        TCON1 = 0x00;           //Tx0¶¨Ê±Æ÷Ê±ÖÓÎªFosc
 221   1        TMOD = 0x00;            //16Î»ÖØ×°ÔØ¶¨Ê±Æ÷/¼ÆÊýÆ÷
 222   1        
 223   1        TH0 = 0xFA;
 224   1        TL0 = 0xCB;             //T0¶¨Ê±Ê±¼ä1ms
 225   1        IE |= 0x02;             //´ò¿ªT0ÖÐ¶Ï
 226   1        TCON |= 0x10;           //Ê¹ÄÜT0
 227   1      }
 228          
 229          void  buzzer(char type)
 230          {
 231   1        static char inited=0;
 232   1        static int t0=0;  
 233   1        if(inited==0)
 234   1        {
 235   2          inited=1;
 236   2          P3M5 = 0xC2;                        //P03设置为推挽输出
 237   2          PWM3_MAP = 0x35;          //PWM3映射P03口
 238   2          PWM3P = 0x20;           //PWM周期为0xFF
 239   2          PWM3D = 0x10;           //PWM占空比设置
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 5   

 240   2        }
 241   1      
 242   1        if(type==1)
 243   1        {     
 244   2          PWM3C = 0x97;             //使能PWM3，关闭中断，允许输出，时钟4分频
 245   2          t0=50;
 246   2        }
 247   1        else if(type==2)
 248   1        {
 249   2          PWM3C = 0x97;             //使能PWM3，关闭中断，允许输出，时钟4分频
 250   2          t0=100;
 251   2        }
 252   1        else if(type==3)
 253   1        {
 254   2          PWM3C = 0x97;             //使能PWM3，关闭中断，允许输出，时钟4分频
 255   2          t0=250;
 256   2        }
 257   1        else if(type==4)
 258   1        {
 259   2          PWM3C = 0x97;             //使能PWM3，关闭中断，允许输出，时钟4分频
 260   2          t0=2500;
 261   2        }
 262   1        else if(type==5)
 263   1        {
 264   2          PWM3C = 0x97;             //使能PWM3，关闭中断，允许输出，时钟4分频
 265   2          t0=300;
 266   2        }
 267   1        if(t0>0)
 268   1        { 
 269   2          t0--; 
 270   2          if(g_err_code!=0)
 271   2          {
 272   3            if(t0%125==0)
 273   3            {
 274   4              static char rr=0;
 275   4              if(rr==0)
 276   4              {
 277   5                PWM3C = 0x07;
 278   5                rr=1;
 279   5              }
 280   4              else
 281   4              {
 282   5                PWM3C = 0x97; 
 283   5                rr=0;
 284   5              }
 285   4              
 286   4            }
 287   3          }
 288   2          if(g_peng_ren_over==1 && g_err_code==0)
 289   2          {
 290   3            if(t0%50==0)
 291   3            {
 292   4              static char rr=0;
 293   4              if(rr==0)
 294   4              {
 295   5                PWM3C = 0x07;
 296   5                rr=1;
 297   5              }
 298   4              else
 299   4              {
 300   5                PWM3C = 0x97; 
 301   5                rr=0;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 6   

 302   5              }
 303   4              
 304   4            }
 305   3          }   
 306   2          if(t0==0)
 307   2          {
 308   3            PWM3C = 0x07;
 309   3          }
 310   2      
 311   2        }
 312   1        
 313   1        
 314   1      }
 315          /*************************************ADC************************************************/
 316          //0~119℃
 317          u16 code Temp_Table[200]={
 318          66,69,73,77,81,85,89,94,98,103,108,114,119,125,131,137,144,150,158,165,173,180,189,197,206,215,
 319          225,234,244,254,264,275,286,298,310,322,334,347,361,374,388,402,417,432,448,464,480,497,514,532,
 320          549,568,587,606,625,645,666,687,708,730,752,774,797,820,844,868,892,917,942,967,993,1019,1046,1073,
 321          3394,1127,1155,1183,1211,1239,1268,1297,1326,1355,1385,1414,1444,1474,1504,1535,1565,1596,1626,1657,
 322          1688,1718,1749,1779,1810,1841,1871,1901,1932,1962,1992,2022,2051,2081,2110,2139,2168,2197,2226,2254,
 323          2282,2310,2337,2381,2392,2419,2445,2471,2497,2523,2548,2573,2598,2622,2646,2670,2693,2716,2739,2762,
 324          2784,2806,2828,2849,2870,2891,2911,2931,2951,2971,2990,3009,3028,3046,3064,3082,3099,3116,3133,3150,
 325          3167,3183,3199,3214,3230,3245,3260,3275,3289,3303,3317,3331,3345,3358,3371,3384,3396,3409,3421,3433,
 326          3445,3456,3468,3479,3490,3501,3511,3522,3532,3542,3549,3561,3571,3580,3589,3598,3607,3615,3624,3632,
 327          3640,3648,3656,3663,3671,3678
 328          };
 329          
 330          void init_ntc_adc()
 331          {
 332   1        
 333   1        P2M5 = 0x02;                //
 334   1        ADCC0 = 0x80;           //
 335   1        Delay_50us(1);            //
 336   1        ADCC1 = 0x0D;           //
 337   1        ADCC2 = 0x4B;           //  
 338   1      }
 339          unsigned int get_ntc_adc()
 340          {
 341   1        ADCC0 |= 0x40;          //
 342   1        while(!(ADCC0&0x20));     //
 343   1        ADCC0 &=~ 0x20;         //
 344   1        return ADCR;
 345   1      }
 346          
 347          
 348          void get_temp()
 349          {
 350   1        u16 n=0;
 351   1        u16 ntc_adc=get_ntc_adc();
 352   1        
 353   1        for(n=0;n<200;n++)
 354   1        {
 355   2          if(Temp_Table[n]>ntc_adc)
 356   2          {
 357   3            break;
 358   3          }
 359   2        }
 360   1      
 361   1        if(g_yu_yue_shi_jian==0 && g_work_start==1 && ntc_adc==0 && g_err_code==0)
 362   1        {
 363   2          if(g_RLY_work_time>30000)
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 7   

 364   2          {
 365   3            Delay_ms(2);
 366   3            if(get_ntc_adc()==0)
 367   3            {
 368   4              g_err_code=1;
 369   4              buzzer(4);
 370   4            }
 371   3          }
 372   2          
 373   2        }
 374   1        else if(g_yu_yue_shi_jian==0 && g_work_start==1 && ntc_adc>=4090 && g_err_code==0)
 375   1        {
 376   2          Delay_ms(2);
 377   2          if(get_ntc_adc()>=4090)
 378   2          {
 379   3            g_err_code=2;
 380   3            buzzer(4);
 381   3          }
 382   2        }
 383   1        else if(g_yu_yue_shi_jian==0 && g_work_start==1 && ntc_adc>3676 && g_err_code==0)
 384   1        {
 385   2          Delay_ms(2);
 386   2          if(get_ntc_adc()>3676)
 387   2          {
 388   3            // g_err_code=3;
 389   3            buzzer(4);
 390   3          }
 391   2        }
 392   1        g_currnet_temp=n;
 393   1      
 394   1      }
 395          void check_ya_li_kai_guan()
 396          {
 397   1        if(g_yu_yue_shi_jian==0 && g_work_start==1 && g_currnet_temp<80 && KG==1 && g_err_code==0)
 398   1        {
 399   2          g_err_code=4;
 400   2          buzzer(4);
 401   2        }
 402   1      }
 403          
 404          void init_display()
 405          {
 406   1        //COM
 407   1        C_PIN6=OD_OUTPUT;
 408   1        C_PIN7=OD_OUTPUT;
 409   1        C_PIN8=OD_OUTPUT;
 410   1      
 411   1        C_PIN19=OD_OUTPUT;
 412   1        C_PIN22=OD_OUTPUT;
 413   1        C_PIN23=OD_OUTPUT;
 414   1        C_PIN10=OD_OUTPUT;
 415   1      
 416   1        //SEG
 417   1        C_PIN18=PP_OUTPUT;
 418   1        C_PIN15=PP_OUTPUT;
 419   1        C_PIN17=PP_OUTPUT;
 420   1        C_PIN24=PP_OUTPUT;
 421   1        C_PIN16=PP_OUTPUT;
 422   1        C_PIN21=PP_OUTPUT;
 423   1        C_PIN25=PP_OUTPUT;
 424   1        C_PIN26=PP_OUTPUT;
 425   1        C_PIN9=PP_OUTPUT;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 8   

 426   1        C_PIN20=PP_OUTPUT;
 427   1      
 428   1          //COM
 429   1        PIN19=1;  PIN22=1;  PIN23=1;  PIN10=1;
 430   1        PIN6=1; PIN7=1; PIN8=1; 
 431   1        //SEG
 432   1        PIN18=0;  PIN15=0;  PIN17=0;  PIN24=0;  PIN16=0;  PIN21=0;  PIN25=0;
 433   1        PIN26=0;  PIN9=0;   PIN20=0;
 434   1      
 435   1      }
 436          void display()
 437          {
 438   1        static char index=0;
 439   1        init_display();
 440   1        //COM
 441   1        PIN19=1;  PIN22=1;  PIN23=1;  PIN10=1;
 442   1        PIN6=1; PIN7=1; PIN8=1; 
 443   1        //SEG
 444   1        PIN18=0;  PIN15=0;  PIN17=0;  PIN24=0;  PIN16=0;  PIN21=0;  PIN25=0;
 445   1        PIN26=0;  PIN9=0;   PIN20=0;
 446   1        if(index<4)
 447   1        {
 448   2          switch(g_shu_ma_guan[index])
 449   2          {
 450   3      
 451   3            case 0:
 452   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 453   3              break;
 454   3            case 1:
 455   3              DISPLAY_A=0;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 456   3              break;
 457   3            case 2:
 458   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=0;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=0;  DISPLAY_G=1;
 459   3              break;
 460   3            case 3:
 461   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=1;
 462   3              break;
 463   3            case 4:
 464   3              DISPLAY_A=0;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=1;
 465   3              break;
 466   3            case 5:
 467   3              DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=1;
 468   3              break;
 469   3            case 6:
 470   3              DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 471   3              break;
 472   3            case 7:
 473   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 474   3              break;
 475   3            case 8:
 476   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 477   3              break;
 478   3            case 9:
 479   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=1;
 480   3              break;
 481   3            case 'E':
 482   3              DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 483   3              break;
 484   3            case '-':
 485   3              DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=1;
 486   3              break;
 487   3            case 'P':
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 9   

 488   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 489   3              break;
 490   3            case 'C':
 491   3              DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 492   3              break;
 493   3            case 'b':
 494   3              DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=1;
 495   3              break;
 496   3            case 10:
 497   3              DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 498   3              break;
 499   3            case 11:
 500   3              DISPLAY_A=0;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 501   3              break;
 502   3            case 12:
 503   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 504   3              break;
 505   3            case 13:
 506   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=1;  DISPLAY_G=0;
 507   3              break;
 508   3            case 14:
 509   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 510   3              break;
 511   3            case 15:
 512   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 513   3              break;
 514   3            case 16:
 515   3              DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=0;  DISPLAY_G=0;
 516   3              break;
 517   3            case 17:
 518   3              DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 519   3              break;
 520   3            case 18:
 521   3              DISPLAY_A=1;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 522   3              break;
 523   3            case 19:
 524   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 525   3              break;
 526   3            case 20:
 527   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=0;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 528   3              break;
 529   3            case 21:
 530   3              DISPLAY_A=1;  DISPLAY_B=1;  DISPLAY_C=1;  DISPLAY_D=1;  DISPLAY_E=1;  DISPLAY_F=1;  DISPLAY_G=0;
 531   3              break;
 532   3            default:
 533   3              DISPLAY_A=0;  DISPLAY_B=0;  DISPLAY_C=0;  DISPLAY_D=0;  DISPLAY_E=0;  DISPLAY_F=0;  DISPLAY_G=0;
 534   3              break;
 535   3            
 536   3          }
 537   2      
 538   2          
 539   2        }
 540   1        if(index==0)
 541   1        {
 542   2          PIN19=0;
 543   2        }
 544   1        else if(index==1)
 545   1        {
 546   2          PIN22=0;
 547   2          DISPLAY_DP=g_shi_jian_liang_dian;
 548   2        }
 549   1        else if(index==2)
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 10  

 550   1        {
 551   2          PIN23=0;
 552   2        }
 553   1        else if(index==3)
 554   1        {
 555   2          PIN10=0;
 556   2        }
 557   1        else if(index==4)
 558   1        {
 559   2          PIN18=g_dun_tang_led; PIN15=g_ji_ya_led;  PIN17=g_jian_cao_led; PIN24=g_bao_wen_led;  PIN16=g_chang_duan_l
             -ed[1];  
 560   2          PIN21=g_yan_mai_led;  PIN25=g_mi_fan_led;   PIN26=g_dou_lei_led;  PIN9=g_chang_duan_led[1]; PIN20=g_din_wen
             -_peng_ren_led;
 561   2          
 562   2          PIN6=0;
 563   2        }
 564   1        else if(index==5)
 565   1        {
 566   2          PIN18=g_lao_huo_man_dun_led;  PIN15=g_chang_duan_led[0];  PIN17=g_jian_kang_zheng_led;  PIN24=g_dan_gao_led
             -;  PIN16=g_fa_jiao_led; 
 567   2          PIN21=g_ji_dan_led; PIN25=1;    PIN26=g_zha_liang_led;  PIN9=g_chang_duan_led[1]; PIN20=g_L_led;
 568   2          
 569   2          PIN7=0;
 570   2        }
 571   1        else if(index==6)
 572   1        {
 573   2          PIN18=g_P_led;  PIN15=g_chang_duan_led[0];  PIN17=g_suan_nao_led; PIN24=g_feng_pei_led; PIN16=g_xiao_du_le
             -d;  
 574   2          PIN21=g_chang_duan_led[2];  PIN25=0;    PIN26=g_chang_duan_led[2];  PIN9=g_chang_duan_led[2]; PIN20=g_dun_ro
             -u_led;
 575   2          PIN8=0;
 576   2        }
 577   1        else
 578   1        {
 579   2      
 580   2        }
 581   1      
 582   1        index++;
 583   1        if(index==7)
 584   1        {
 585   2          index=0;
 586   2        }
 587   1      
 588   1      }
 589          
 590          void show_shu_ma_guan_seting()
 591          {
 592   1        if(g_seting_wen_du==0)
 593   1        {
 594   2          if(g_work_mode!=BAO_WEN)
 595   2          {
 596   3            if(g_dai_P==0)
 597   3            {
 598   4              g_shu_ma_guan[0]=g_peng_ren_shi_chang/600;
 599   4              g_shu_ma_guan[1]=(g_peng_ren_shi_chang%600)/60;
 600   4              g_shu_ma_guan[2]=(g_peng_ren_shi_chang%60)/10;
 601   4              g_shu_ma_guan[3]=g_peng_ren_shi_chang%10;
 602   4              g_shi_jian_liang_dian=1;
 603   4            }
 604   3            else
 605   3            {
 606   4              g_shu_ma_guan[0]='X';
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 11  

 607   4              g_shu_ma_guan[1]='P';
 608   4              g_shu_ma_guan[2]=(g_peng_ren_shi_chang%60)/10;
 609   4              g_shu_ma_guan[3]=g_peng_ren_shi_chang%10;
 610   4              g_shi_jian_liang_dian=0;
 611   4            }
 612   3            
 613   3            if(g_yu_yue_shi_jian>0 || g_yu_yue_ing==1)
 614   3            {
 615   4              g_shu_ma_guan[0]=g_yu_yue_shi_jian/600;
 616   4              g_shu_ma_guan[1]=(g_yu_yue_shi_jian%600)/60;
 617   4              g_shu_ma_guan[2]=(g_yu_yue_shi_jian%60)/10;
 618   4              g_shu_ma_guan[3]=g_yu_yue_shi_jian%10;
 619   4              g_shi_jian_liang_dian=1;
 620   4            }
 621   3            
 622   3          }
 623   2          else{
 624   3      
 625   3            g_shu_ma_guan[0]='X';
 626   3            g_shu_ma_guan[1]='X';
 627   3            g_shu_ma_guan[2]='b';
 628   3            g_shu_ma_guan[3]='b';
 629   3          }
 630   2        }
 631   1        else
 632   1        {
 633   2          g_shu_ma_guan[0]='X';
 634   2          g_shu_ma_guan[1]=g_peng_ren_wen_du/10;
 635   2          g_shu_ma_guan[2]=g_peng_ren_wen_du%10;
 636   2          g_shu_ma_guan[3]='C';
 637   2          g_shi_jian_liang_dian=0;
 638   2          
 639   2        }
 640   1      
 641   1        
 642   1      }
 643          void show_shu_ma_guan_working()
 644          {
 645   1        static short t1=0;
 646   1        if(g_work_mode!=BAO_WEN)
 647   1        {
 648   2          if(g_dai_P==0 || g_yu_yue_shi_jian>0)
 649   2          {
 650   3            g_shu_ma_guan[0]=g_peng_ren_shi_chang/600;
 651   3            g_shu_ma_guan[1]=(g_peng_ren_shi_chang%600)/60;
 652   3            g_shu_ma_guan[2]=(g_peng_ren_shi_chang%60)/10;
 653   3            g_shu_ma_guan[3]=g_peng_ren_shi_chang%10;   
 654   3            if(g_yu_yue_shi_jian>0)
 655   3            {
 656   4              g_shu_ma_guan[0]=g_yu_yue_shi_jian/600;
 657   4              g_shu_ma_guan[1]=(g_yu_yue_shi_jian%600)/60;
 658   4              g_shu_ma_guan[2]=(g_yu_yue_shi_jian%60)/10;
 659   4              g_shu_ma_guan[3]=g_yu_yue_shi_jian%10;
 660   4              
 661   4            }
 662   3              
 663   3            if(t1==1)
 664   3            {
 665   4              g_shi_jian_liang_dian=1;
 666   4            }
 667   3            else if(t1==250)
 668   3            {
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 12  

 669   4              g_shi_jian_liang_dian=0;
 670   4            }
 671   3            else if(t1>500)
 672   3            {
 673   4              t1=0;
 674   4            } 
 675   3            t1++;       
 676   3      
 677   3            if(g_dai_no_P==1 && g_P_bao_ya_counter_start==0)
 678   3            {
 679   4              g_shi_jian_liang_dian=1;
 680   4            } 
 681   3      
 682   3          }
 683   2          else
 684   2          {
 685   3            
 686   3            g_shu_ma_guan[2]=(g_peng_ren_shi_chang%60)/10;
 687   3            g_shu_ma_guan[3]=g_peng_ren_shi_chang%10;
 688   3            if(g_hoting==1)
 689   3            {
 690   4              g_shi_jian_liang_dian=0;
 691   4              if(t1==1)
 692   4              {
 693   5                g_shu_ma_guan[0]=10;
 694   5                g_shu_ma_guan[1]=16;
 695   5              }
 696   4              else if(t1==200)
 697   4              {
 698   5                g_shu_ma_guan[0]=11;
 699   5                g_shu_ma_guan[1]=17;
 700   5              }
 701   4              else if(t1==400)
 702   4              {
 703   5                g_shu_ma_guan[0]=12;
 704   5                g_shu_ma_guan[1]=18;
 705   5              }
 706   4              else if(t1==600)
 707   4              {
 708   5                g_shu_ma_guan[0]=13;
 709   5                g_shu_ma_guan[1]=19;
 710   5              }
 711   4              else if(t1==800)
 712   4              {
 713   5                g_shu_ma_guan[0]=14;
 714   5                g_shu_ma_guan[1]=20;
 715   5              }
 716   4              else if(t1==1000)
 717   4              {
 718   5                g_shu_ma_guan[0]=15;
 719   5                g_shu_ma_guan[1]=21;
 720   5              }
 721   4              else if(t1>1200)
 722   4              {
 723   5                t1=0;
 724   5              }
 725   4          
 726   4              t1++;
 727   4            }
 728   3            else
 729   3            {
 730   4              g_shu_ma_guan[0]='X';
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 13  

 731   4              g_shu_ma_guan[1]='P';
 732   4              if(t1==1)
 733   4              {
 734   5                g_shi_jian_liang_dian=1;
 735   5              }
 736   4              else if(t1==250)
 737   4              {
 738   5                g_shi_jian_liang_dian=0;
 739   5              }
 740   4              else if(t1>500)
 741   4              {
 742   5                t1=0;
 743   5              } 
 744   4              t1++;
 745   4            }
 746   3          }   
 747   2          
 748   2        }
 749   1        else{
 750   2      
 751   2          g_shu_ma_guan[0]='X';
 752   2          g_shu_ma_guan[1]='X';
 753   2          g_shu_ma_guan[2]='b';
 754   2          g_shu_ma_guan[3]='b';
 755   2          g_shi_jian_liang_dian=0;
 756   2        }
 757   1          
 758   1      }
 759          
 760          void show_none()
 761          {
 762   1        g_din_wen_peng_ren_led=0;
 763   1        g_dun_rou_led=0;
 764   1        g_dun_tang_led=0;
 765   1        g_lao_huo_man_dun_led=0;
 766   1        g_jian_kang_zheng_led=0;
 767   1        g_jian_cao_led=0;
 768   1        g_suan_nao_led=0;
 769   1        g_fa_jiao_led=0;
 770   1        g_xiao_du_led=0;
 771   1        g_dan_gao_led=0;
 772   1        g_feng_pei_led=0;
 773   1        g_ji_ya_led=0;
 774   1        g_mi_fan_led=0;
 775   1        g_dou_lei_led=0;
 776   1        g_zha_liang_led=0;
 777   1        g_yan_mai_led=0;
 778   1        g_ji_dan_led=0;
 779   1        g_bao_wen_led=0;
 780   1        g_chang_duan_led[0]=0;
 781   1        g_chang_duan_led[1]=0;
 782   1        g_chang_duan_led[2]=0;
 783   1        if(g_work_start==0)
 784   1        {
 785   2          g_shu_ma_guan[0]='X';
 786   2          g_shu_ma_guan[1]='X';
 787   2          g_shu_ma_guan[2]='X';
 788   2          g_shu_ma_guan[3]='X';
 789   2      
 790   2        }
 791   1        
 792   1        g_L_led=0;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 14  

 793   1        g_P_led=0;
 794   1      
 795   1      }
 796          void show_all()
 797          {
 798   1        g_din_wen_peng_ren_led=1;
 799   1        g_dun_rou_led=1;
 800   1        g_dun_tang_led=1;
 801   1        g_lao_huo_man_dun_led=1;
 802   1        g_jian_kang_zheng_led=1;
 803   1        g_jian_cao_led=1;
 804   1        g_suan_nao_led=1;
 805   1        g_fa_jiao_led=1;
 806   1        g_xiao_du_led=1;
 807   1        g_dan_gao_led=1;
 808   1        g_feng_pei_led=1;
 809   1        g_ji_ya_led=1;
 810   1        g_mi_fan_led=1;
 811   1        g_dou_lei_led=1;
 812   1        g_zha_liang_led=1;
 813   1        g_yan_mai_led=1;
 814   1        g_ji_dan_led=1;
 815   1        g_bao_wen_led=1;
 816   1        g_chang_duan_led[0]=1;
 817   1        g_chang_duan_led[1]=1;
 818   1        g_chang_duan_led[2]=1;
 819   1      
 820   1        g_shu_ma_guan[0]=8;
 821   1        g_shu_ma_guan[1]=8;
 822   1        g_shu_ma_guan[2]=8;
 823   1        g_shu_ma_guan[3]=8;
 824   1        
 825   1        g_L_led=1;
 826   1        g_P_led=1;
 827   1      
 828   1      }
 829          void show_stop()
 830          {
 831   1        show_none();
 832   1        g_shu_ma_guan[0]=0;
 833   1        g_shu_ma_guan[1]=0;
 834   1        g_shu_ma_guan[2]=0;
 835   1        g_shu_ma_guan[3]=0;
 836   1        g_shi_jian_liang_dian=0;
 837   1        if(g_kid_lock==1)
 838   1        {
 839   2          g_L_led=1;
 840   2        }
 841   1        if(g_err_code!=0)
 842   1        {
 843   2          g_shu_ma_guan[0]='X';
 844   2          g_shu_ma_guan[1]='X';
 845   2          g_shu_ma_guan[2]='E';
 846   2          g_shu_ma_guan[3]=g_err_code;
 847   2        }
 848   1        if(g_stop_counter>240000)
 849   1        {
 850   2          g_shu_ma_guan[0]='X';
 851   2          g_shu_ma_guan[1]='X';
 852   2          g_shu_ma_guan[2]='X';
 853   2          g_shu_ma_guan[3]='X';
 854   2        }
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 15  

 855   1        else
 856   1        {
 857   2          g_stop_counter+=2;
 858   2        }
 859   1      
 860   1      }
 861          void show_chang_duan()
 862          {
 863   1      
 864   1        if(g_peng_ren_chang_duan_shi_jian==0){
 865   2          g_chang_duan_led[0]=1;
 866   2          g_chang_duan_led[1]=0;
 867   2          g_chang_duan_led[2]=0;
 868   2        }
 869   1        else if(g_peng_ren_chang_duan_shi_jian==1){
 870   2          g_chang_duan_led[0]=1;
 871   2          g_chang_duan_led[1]=1;
 872   2          g_chang_duan_led[2]=0;
 873   2        }
 874   1        else if(g_peng_ren_chang_duan_shi_jian==2){
 875   2          g_chang_duan_led[0]=1;
 876   2          g_chang_duan_led[1]=1;
 877   2          g_chang_duan_led[2]=1;
 878   2        }
 879   1      
 880   1      }
 881          void show_led()
 882          {
 883   1        switch(g_work_mode)
 884   1        {
 885   2          case DIN_WEN_PENG_REN:
 886   2            g_din_wen_peng_ren_led=1;
 887   2          break;
 888   2          case DUN_ROU:
 889   2            g_dun_rou_led=1;
 890   2            show_chang_duan();
 891   2          break;    
 892   2          case DUN_TANG:
 893   2            g_dun_tang_led=1; 
 894   2            show_chang_duan();
 895   2          break;
 896   2          case LAO_HUO_MAN_DUN:
 897   2            g_lao_huo_man_dun_led=1;
 898   2          break;
 899   2          case JIAN_KANG_ZHENG:
 900   2            g_jian_kang_zheng_led=1;
 901   2            show_chang_duan();
 902   2          break;
 903   2          case JIAN_CAO:
 904   2            g_jian_cao_led=1;
 905   2          break;
 906   2          case MI_FAN:
 907   2            g_mi_fan_led=1;
 908   2            show_chang_duan();
 909   2          break;
 910   2          case DOU_LEI:
 911   2            g_dou_lei_led=1;
 912   2            show_chang_duan();
 913   2          break;
 914   2          case ZHA_LIANG:
 915   2            g_zha_liang_led=1;
 916   2            show_chang_duan();
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 16  

 917   2          break;
 918   2          case YAN_MAI:
 919   2            g_yan_mai_led=1;
 920   2          break;
 921   2          case JI_DAN:
 922   2            g_ji_dan_led=1;
 923   2          break;
 924   2          case SUAN_NAO:
 925   2            g_suan_nao_led=1;
 926   2          break;
 927   2          case FA_JIAO:
 928   2            g_fa_jiao_led=1;
 929   2          break;
 930   2          case XIAO_DU:
 931   2            g_xiao_du_led=1;
 932   2          break;
 933   2          case DAN_GAO:
 934   2            g_dan_gao_led=1;
 935   2          break;
 936   2          case FENG_PEI:
 937   2            g_feng_pei_led=1;
 938   2          break;
 939   2          case JI_YA:
 940   2            g_ji_ya_led=1;
 941   2          break;
 942   2          case BAO_WEN:
 943   2            g_bao_wen_led=1;
 944   2          break;
 945   2          default:
 946   2          break;
 947   2        
 948   2        }
 949   1        if(g_yu_yue_shi_jian>0)
 950   1        {
 951   2          g_P_led=1;
 952   2        }
 953   1        else
 954   1        {
 955   2          g_P_led=0;
 956   2        }
 957   1        if(g_kid_lock==1)
 958   1        {
 959   2          g_L_led=1;
 960   2        }
 961   1        else
 962   1        {
 963   2          g_L_led=0;
 964   2        }
 965   1      }
 966          void show_seting()
 967          {
 968   1        show_none();
 969   1        show_shu_ma_guan_seting();
 970   1        show_led();
 971   1        
 972   1      
 973   1      }
 974          void key_scan()
 975          {
 976   1        
 977   1      
 978   1        C_PIN20=SS_INPUT;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 17  

 979   1        C_PIN18=SS_INPUT;
 980   1        C_PIN17=SS_INPUT;
 981   1        C_PIN24=SS_INPUT;
 982   1        C_PIN21=SS_INPUT;
 983   1        C_PIN26=SS_INPUT;
 984   1        C_PIN25=SS_INPUT;
 985   1        C_PIN16=SS_INPUT;
 986   1        C_PIN9=SS_INPUT;
 987   1        C_PIN13=SS_INPUT;
 988   1        C_PIN15=SS_INPUT;
 989   1      
 990   1        //¹Ø±ÕÊýÂë¹Ü
 991   1        PIN19=1;  PIN22=1;  PIN23=1;  PIN10=1;
 992   1        PIN6=1; PIN7=1; PIN8=1; 
 993   1      
 994   1        g_key_code=0;
 995   1        C_PIN12=PP_OUTPUT;
 996   1        C_PIN13=AN_INPUT;
 997   1        PIN12=1;
 998   1        Delay_1us(1);
 999   1        
1000   1        g_key_code =S18?18:S2?2:S4?4:S11?11:S9?9:S6?6:S15?15:S19?19:S16?16:0;
1001   1        if(g_key_code==0)
1002   1        {
1003   2          C_PIN12=AN_INPUT;
1004   2          C_PIN13=PP_OUTPUT;
1005   2          PIN13=1;  
1006   2          Delay_1us(1); 
1007   2          g_key_code =S10?10:S12?12:S17?17:S3?3:S8?8:S1?1:S14?14:S5?5:S7?7:S13?13:0;
1008   2        }
1009   1      
1010   1        C_PIN12=AN_INPUT;
1011   1        C_PIN13=AN_INPUT;
1012   1      } 
1013          void key_plus()
1014          {
1015   1        if(g_yu_yue_shi_jian>0 || g_yu_yue_ing==1)
1016   1        {
1017   2          g_yu_yue_shi_jian+=30;
1018   2          if(g_yu_yue_shi_jian>24*60)
1019   2          {
1020   3            g_yu_yue_shi_jian=0;
1021   3          }
1022   2        }
1023   1        else
1024   1        {
1025   2          if(g_work_mode==DIN_WEN_PENG_REN)
1026   2          {
1027   3            g_peng_ren_shi_chang+=1;
1028   3            if(g_peng_ren_shi_chang>24*60)
1029   3            {
1030   4              g_peng_ren_shi_chang=20;
1031   4            }
1032   3          }
1033   2          else if(g_work_mode==DUN_ROU)
1034   2          {
1035   3            g_peng_ren_shi_chang+=1;
1036   3            if(g_peng_ren_shi_chang>59)
1037   3            {
1038   4              g_peng_ren_shi_chang=1;
1039   4            }
1040   3          }
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 18  

1041   2          else if(g_work_mode==DUN_TANG)
1042   2          {
1043   3            g_peng_ren_shi_chang+=1;
1044   3            if(g_peng_ren_shi_chang>59)
1045   3            {
1046   4              g_peng_ren_shi_chang=1;
1047   4            }
1048   3          }
1049   2          else if(g_work_mode==LAO_HUO_MAN_DUN)
1050   2          {
1051   3            g_peng_ren_shi_chang+=30;
1052   3            if(g_peng_ren_shi_chang>10*60)
1053   3            {
1054   4              g_peng_ren_shi_chang=2*60;
1055   4            }
1056   3          }
1057   2          else if(g_work_mode==JIAN_KANG_ZHENG)
1058   2          {
1059   3            g_peng_ren_shi_chang+=1;
1060   3            if(g_peng_ren_shi_chang>59)
1061   3            {
1062   4              g_peng_ren_shi_chang=1;
1063   4            }
1064   3          }
1065   2          else if(g_work_mode==JIAN_CAO)
1066   2          {
1067   3            g_peng_ren_shi_chang+=1;
1068   3            if(g_peng_ren_shi_chang>59)
1069   3            {
1070   4              g_peng_ren_shi_chang=1;
1071   4            }
1072   3          }
1073   2          else if(g_work_mode==MI_FAN)
1074   2          {
1075   3            g_peng_ren_shi_chang+=1;
1076   3            if(g_peng_ren_shi_chang>59)
1077   3            {
1078   4              g_peng_ren_shi_chang=1;
1079   4            }
1080   3          }
1081   2          else if(g_work_mode==DOU_LEI)
1082   2          {
1083   3            g_peng_ren_shi_chang+=1;
1084   3            if(g_peng_ren_shi_chang>59)
1085   3            {
1086   4              g_peng_ren_shi_chang=1;
1087   4            }
1088   3          }
1089   2          else if(g_work_mode==ZHA_LIANG)
1090   2          {
1091   3            g_peng_ren_shi_chang+=1;
1092   3            if(g_peng_ren_shi_chang>59)
1093   3            {
1094   4              g_peng_ren_shi_chang=1;
1095   4            }
1096   3          }
1097   2          else if(g_work_mode==YAN_MAI)
1098   2          {
1099   3            g_peng_ren_shi_chang+=1;
1100   3            if(g_peng_ren_shi_chang>59)
1101   3            {
1102   4              g_peng_ren_shi_chang=1;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 19  

1103   4            }
1104   3          }
1105   2          else if(g_work_mode==JI_DAN)
1106   2          {
1107   3            g_peng_ren_shi_chang+=1;
1108   3            if(g_peng_ren_shi_chang>59)
1109   3            {
1110   4              g_peng_ren_shi_chang=1;
1111   4            }
1112   3          }
1113   2          else if(g_work_mode==SUAN_NAO)
1114   2          {
1115   3            g_peng_ren_shi_chang+=30;
1116   3            if(g_peng_ren_shi_chang>12*60)
1117   3            {
1118   4              g_peng_ren_shi_chang=6*60;
1119   4            }
1120   3          }
1121   2          else if(g_work_mode==FA_JIAO)
1122   2          {
1123   3            g_peng_ren_shi_chang+=10;
1124   3            if(g_peng_ren_shi_chang>7*60)
1125   3            {
1126   4              g_peng_ren_shi_chang=2*60;
1127   4            }
1128   3          }
1129   2          else if(g_work_mode==XIAO_DU)
1130   2          {
1131   3            g_peng_ren_shi_chang+=1;
1132   3            if(g_peng_ren_shi_chang>59)
1133   3            {
1134   4              g_peng_ren_shi_chang=1;
1135   4            }
1136   3          }
1137   2          else if(g_work_mode==DAN_GAO)
1138   2          {
1139   3            g_peng_ren_shi_chang+=1;
1140   3            if(g_peng_ren_shi_chang>59)
1141   3            {
1142   4              g_peng_ren_shi_chang=1;
1143   4            }
1144   3          }
1145   2          else if(g_work_mode==FENG_PEI)
1146   2          {
1147   3            g_peng_ren_shi_chang+=1;
1148   3            if(g_peng_ren_shi_chang>59)
1149   3            {
1150   4              g_peng_ren_shi_chang=1;
1151   4            }
1152   3          }
1153   2          else if(g_work_mode==JI_YA)
1154   2          {
1155   3            g_peng_ren_shi_chang+=1;
1156   3            if(g_peng_ren_shi_chang>59)
1157   3            {
1158   4              g_peng_ren_shi_chang=1;
1159   4            }
1160   3          }
1161   2        }
1162   1      }
1163          void key_jian()
1164          {
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 20  

1165   1        if(g_yu_yue_shi_jian>0 || g_yu_yue_ing==1)
1166   1        {
1167   2          
1168   2          if(g_yu_yue_shi_jian==0)
1169   2          {
1170   3            g_yu_yue_shi_jian=24*60;      
1171   3          }
1172   2          else
1173   2          {
1174   3            g_yu_yue_shi_jian-=30;
1175   3          }
1176   2      
1177   2        }
1178   1        else
1179   1        {
1180   2          if(g_work_mode==DIN_WEN_PENG_REN)
1181   2          {
1182   3            
1183   3            if(g_peng_ren_shi_chang>=20)
1184   3            {
1185   4              g_peng_ren_shi_chang-=1;
1186   4              if(g_peng_ren_shi_chang<20)
1187   4              {
1188   5                g_peng_ren_shi_chang=24*60;
1189   5              }
1190   4              
1191   4            }
1192   3          }
1193   2          else if(g_work_mode==DUN_ROU)
1194   2          {
1195   3            if(g_peng_ren_shi_chang>=1)
1196   3            {
1197   4              g_peng_ren_shi_chang-=1;
1198   4              if(g_peng_ren_shi_chang==0)
1199   4              {
1200   5                g_peng_ren_shi_chang=59;
1201   5              }
1202   4            }
1203   3          }
1204   2          else if(g_work_mode==DUN_TANG)
1205   2          {
1206   3            if(g_peng_ren_shi_chang>=1)
1207   3            {
1208   4              g_peng_ren_shi_chang-=1;
1209   4              if(g_peng_ren_shi_chang==0)
1210   4              {
1211   5                g_peng_ren_shi_chang=59;
1212   5              }
1213   4            }
1214   3          }
1215   2          else if(g_work_mode==LAO_HUO_MAN_DUN)
1216   2          {
1217   3            if(g_peng_ren_shi_chang>=2*60)
1218   3            {
1219   4              g_peng_ren_shi_chang-=30;
1220   4              if(g_peng_ren_shi_chang<2*60)
1221   4              {
1222   5                g_peng_ren_shi_chang=10*60;
1223   5              }
1224   4      
1225   4            }
1226   3          }
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 21  

1227   2          else if(g_work_mode==JIAN_KANG_ZHENG)
1228   2          {
1229   3            if(g_peng_ren_shi_chang>=1)
1230   3            {
1231   4              g_peng_ren_shi_chang-=1;
1232   4              if(g_peng_ren_shi_chang==0)
1233   4              {
1234   5                g_peng_ren_shi_chang=59;
1235   5              }
1236   4            }
1237   3          }
1238   2          else if(g_work_mode==JIAN_CAO)
1239   2          {
1240   3            if(g_peng_ren_shi_chang>=1)
1241   3            {
1242   4              g_peng_ren_shi_chang-=1;
1243   4              if(g_peng_ren_shi_chang==0)
1244   4              {
1245   5                g_peng_ren_shi_chang=59;
1246   5              }
1247   4            }
1248   3          }
1249   2          else if(g_work_mode==MI_FAN)
1250   2          {
1251   3            if(g_peng_ren_shi_chang>=1)
1252   3            {
1253   4              g_peng_ren_shi_chang-=1;
1254   4              if(g_peng_ren_shi_chang==0)
1255   4              {
1256   5                g_peng_ren_shi_chang=59;
1257   5              }
1258   4            }
1259   3          }
1260   2          else if(g_work_mode==DOU_LEI)
1261   2          {
1262   3            if(g_peng_ren_shi_chang>=1)
1263   3            {
1264   4              g_peng_ren_shi_chang-=1;
1265   4              if(g_peng_ren_shi_chang==0)
1266   4              {
1267   5                g_peng_ren_shi_chang=59;
1268   5              }
1269   4            }
1270   3          }
1271   2          else if(g_work_mode==ZHA_LIANG)
1272   2          {
1273   3            if(g_peng_ren_shi_chang>=1)
1274   3            {
1275   4              g_peng_ren_shi_chang-=1;
1276   4              if(g_peng_ren_shi_chang==0)
1277   4              {
1278   5                g_peng_ren_shi_chang=59;
1279   5              }
1280   4            }
1281   3          }
1282   2          else if(g_work_mode==YAN_MAI)
1283   2          {
1284   3            if(g_peng_ren_shi_chang>=1)
1285   3            {
1286   4              g_peng_ren_shi_chang-=1;
1287   4              if(g_peng_ren_shi_chang==0)
1288   4              {
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 22  

1289   5                g_peng_ren_shi_chang=59;
1290   5              }
1291   4            }
1292   3          }
1293   2          else if(g_work_mode==JI_DAN)
1294   2          {
1295   3            if(g_peng_ren_shi_chang>=1)
1296   3            {
1297   4              g_peng_ren_shi_chang-=1;
1298   4              if(g_peng_ren_shi_chang==0)
1299   4              {
1300   5                g_peng_ren_shi_chang=59;
1301   5              }
1302   4            }
1303   3          }
1304   2          else if(g_work_mode==SUAN_NAO)
1305   2          {
1306   3            if(g_peng_ren_shi_chang>=6*60)
1307   3            {
1308   4              g_peng_ren_shi_chang-=30;
1309   4              if(g_peng_ren_shi_chang<6*60)
1310   4              {
1311   5                g_peng_ren_shi_chang=12*60;
1312   5              }
1313   4      
1314   4            }
1315   3          }
1316   2          else if(g_work_mode==FA_JIAO)
1317   2          {
1318   3            if(g_peng_ren_shi_chang>=2*60)
1319   3            {
1320   4              g_peng_ren_shi_chang-=10;
1321   4              if(g_peng_ren_shi_chang<2*60)
1322   4              {
1323   5                g_peng_ren_shi_chang=7*60;
1324   5              }
1325   4      
1326   4            }
1327   3          }
1328   2          else if(g_work_mode==XIAO_DU)
1329   2          {
1330   3            if(g_peng_ren_shi_chang>=1)
1331   3            {
1332   4              g_peng_ren_shi_chang-=1;
1333   4              if(g_peng_ren_shi_chang==0)
1334   4              {
1335   5                g_peng_ren_shi_chang=59;
1336   5              }
1337   4            }
1338   3          }
1339   2          else if(g_work_mode==DAN_GAO)
1340   2          {
1341   3            if(g_peng_ren_shi_chang>=1)
1342   3            {
1343   4              g_peng_ren_shi_chang-=1;
1344   4              if(g_peng_ren_shi_chang==0)
1345   4              {
1346   5                g_peng_ren_shi_chang=59;
1347   5              }
1348   4            }
1349   3          }
1350   2          else if(g_work_mode==FENG_PEI)
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 23  

1351   2          {
1352   3            if(g_peng_ren_shi_chang>=1)
1353   3            {
1354   4              g_peng_ren_shi_chang-=1;
1355   4              if(g_peng_ren_shi_chang==0)
1356   4              {
1357   5                g_peng_ren_shi_chang=59;
1358   5              }
1359   4            }
1360   3          }
1361   2          else if(g_work_mode==JI_YA)
1362   2          {
1363   3            if(g_peng_ren_shi_chang>=1)
1364   3            {
1365   4              g_peng_ren_shi_chang-=1;
1366   4              if(g_peng_ren_shi_chang==0)
1367   4              {
1368   5                g_peng_ren_shi_chang=59;
1369   5              }
1370   4            }
1371   3          }
1372   2        }
1373   1      }
1374          void xiao_peng_ren_shi_jian()
1375          {
1376   1        if(g_work_mode==DUN_ROU)
1377   1        {
1378   2          buzzer(1);
1379   2          if(g_xiao_peng_ren_shi_jian==0)
1380   2          {
1381   3            g_peng_ren_shi_chang=35;
1382   3            g_xiao_peng_ren_shi_jian=1;
1383   3            g_peng_ren_chang_duan_shi_jian=2;
1384   3          }
1385   2          else if(g_xiao_peng_ren_shi_jian==1)
1386   2          {
1387   3            g_peng_ren_shi_chang=25;
1388   3            g_xiao_peng_ren_shi_jian=2;
1389   3            g_peng_ren_chang_duan_shi_jian=0;
1390   3          }
1391   2          else if(g_xiao_peng_ren_shi_jian==2)
1392   2          {
1393   3            g_peng_ren_shi_chang=30;
1394   3            g_xiao_peng_ren_shi_jian=0;
1395   3            g_peng_ren_chang_duan_shi_jian=1;
1396   3          }
1397   2        }
1398   1        else if(g_work_mode==DUN_TANG)
1399   1        {
1400   2          buzzer(1);
1401   2          if(g_xiao_peng_ren_shi_jian==0)
1402   2          {
1403   3            g_peng_ren_shi_chang=30;
1404   3            g_xiao_peng_ren_shi_jian=1;
1405   3            g_peng_ren_chang_duan_shi_jian=2;
1406   3          }
1407   2          else if(g_xiao_peng_ren_shi_jian==1)
1408   2          {
1409   3            g_peng_ren_shi_chang=20;
1410   3            g_xiao_peng_ren_shi_jian=2;
1411   3            g_peng_ren_chang_duan_shi_jian=0;
1412   3          }
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 24  

1413   2          else if(g_xiao_peng_ren_shi_jian==2)
1414   2          {
1415   3            g_peng_ren_shi_chang=25;
1416   3            g_xiao_peng_ren_shi_jian=0;
1417   3            g_peng_ren_chang_duan_shi_jian=1;
1418   3          }
1419   2        }
1420   1        else if(g_work_mode==JIAN_KANG_ZHENG)
1421   1        {
1422   2          buzzer(1);
1423   2          if(g_xiao_peng_ren_shi_jian==0)
1424   2          {
1425   3            g_peng_ren_shi_chang=15;
1426   3            g_xiao_peng_ren_shi_jian=1;
1427   3            g_peng_ren_chang_duan_shi_jian=2;
1428   3          }
1429   2          else if(g_xiao_peng_ren_shi_jian==1)
1430   2          {
1431   3            g_peng_ren_shi_chang=5;
1432   3            g_xiao_peng_ren_shi_jian=2;
1433   3            g_peng_ren_chang_duan_shi_jian=0;
1434   3          }
1435   2          else if(g_xiao_peng_ren_shi_jian==2)
1436   2          {
1437   3            g_peng_ren_shi_chang=10;
1438   3            g_xiao_peng_ren_shi_jian=0;
1439   3            g_peng_ren_chang_duan_shi_jian=1;
1440   3          }
1441   2        }
1442   1        else if(g_work_mode==MI_FAN)
1443   1        {
1444   2          buzzer(1);
1445   2          if(g_xiao_peng_ren_shi_jian==0)
1446   2          {
1447   3            g_peng_ren_shi_chang=15;
1448   3            g_xiao_peng_ren_shi_jian=1;
1449   3            g_peng_ren_chang_duan_shi_jian=2;
1450   3          }
1451   2          else if(g_xiao_peng_ren_shi_jian==1)
1452   2          {
1453   3            g_peng_ren_shi_chang=10;
1454   3            g_xiao_peng_ren_shi_jian=2;
1455   3            g_peng_ren_chang_duan_shi_jian=0; 
1456   3          }
1457   2          else if(g_xiao_peng_ren_shi_jian==2)
1458   2          {
1459   3            g_peng_ren_shi_chang=12;
1460   3            g_xiao_peng_ren_shi_jian=0;
1461   3            g_peng_ren_chang_duan_shi_jian=1;
1462   3          }
1463   2        }
1464   1        else if(g_work_mode==DOU_LEI)
1465   1        {
1466   2          buzzer(1);
1467   2          if(g_xiao_peng_ren_shi_jian==0)
1468   2          {
1469   3            g_peng_ren_shi_chang=40;
1470   3            g_xiao_peng_ren_shi_jian=1;
1471   3            g_peng_ren_chang_duan_shi_jian=2;
1472   3          }
1473   2          else if(g_xiao_peng_ren_shi_jian==1)
1474   2          {
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 25  

1475   3            g_peng_ren_shi_chang=30;
1476   3            g_xiao_peng_ren_shi_jian=2;
1477   3            g_peng_ren_chang_duan_shi_jian=0;
1478   3          }
1479   2          else if(g_xiao_peng_ren_shi_jian==2)
1480   2          {
1481   3            g_peng_ren_shi_chang=35;
1482   3            g_xiao_peng_ren_shi_jian=0;
1483   3            g_peng_ren_chang_duan_shi_jian=1; 
1484   3          }
1485   2        }
1486   1        else if(g_work_mode==ZHA_LIANG)
1487   1        {
1488   2          buzzer(1);
1489   2          if(g_xiao_peng_ren_shi_jian==0)
1490   2          {
1491   3            g_peng_ren_shi_chang=25;
1492   3            g_xiao_peng_ren_shi_jian=1;
1493   3            g_peng_ren_chang_duan_shi_jian=2;
1494   3          }
1495   2          else if(g_xiao_peng_ren_shi_jian==1)
1496   2          {
1497   3            g_peng_ren_shi_chang=15;
1498   3            g_xiao_peng_ren_shi_jian=2;
1499   3            g_peng_ren_chang_duan_shi_jian=0;
1500   3          }
1501   2          else if(g_xiao_peng_ren_shi_jian==2)
1502   2          {
1503   3            g_peng_ren_shi_chang=20;
1504   3            g_xiao_peng_ren_shi_jian=0;
1505   3            g_peng_ren_chang_duan_shi_jian=1;
1506   3          }
1507   2        }
1508   1      }
1509          void key_operate()
1510          {
1511   1        static char key_on=0;
1512   1        static short long_press_counter=0,one_times=0;
1513   1        if(g_key_code!=0)
1514   1        {
1515   2          if(key_on==1)
1516   2          {     
1517   3            if(long_press_counter<500)
1518   3            {
1519   4              long_press_counter++;
1520   4            }
1521   3            else
1522   3            {
1523   4      
1524   4              if(one_times++>100)
1525   4              {
1526   5                if(g_key_code==16 && g_work_mode!=0 && g_work_start==0)
1527   5                {
1528   6                  key_plus();
1529   6                  if(g_work_mode==DIN_WEN_PENG_REN)
1530   6                  {
1531   7                    key_plus();key_plus();key_plus();key_plus();key_plus();key_plus();key_plus();key_plus();key_plus();
1532   7                  }
1533   6                }
1534   5                else if(g_key_code==15 && g_work_mode!=0 && g_work_start==0)
1535   5                {
1536   6                  key_jian();
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 26  

1537   6                  if(g_work_mode==DIN_WEN_PENG_REN)
1538   6                  {
1539   7                    key_jian();key_jian();key_jian();key_jian();key_jian();key_jian();key_jian();key_jian();key_jian();
1540   7                  }
1541   6                }
1542   5                else if(g_key_code==1 && g_work_mode==DIN_WEN_PENG_REN && g_work_start==0)
1543   5                {
1544   6                  if(g_seting_wen_du==1)
1545   6                  {
1546   7                    g_peng_ren_wen_du++;
1547   7                  }           
1548   6                  if(g_peng_ren_wen_du>90)
1549   6                  {
1550   7                    g_peng_ren_wen_du=45;
1551   7                  }
1552   6                }
1553   5                one_times=0;
1554   5              }
1555   4              if(g_key_code==13 && g_kid_lock==1)
1556   4              {
1557   5                g_kid_lock=0;
1558   5                buzzer(2);
1559   5              }
1560   4              
1561   4            }
1562   3            if(g_work_start==0)
1563   3            {
1564   4              g_operate_counter=0;
1565   4            }
1566   3      
1567   3          }
1568   2          else 
1569   2          { 
1570   3      
1571   3            long_press_counter=0;
1572   3            key_on=1;
1573   3      
1574   3            if(g_stop_counter>=240000)
1575   3            {
1576   4              g_stop_counter=0;
1577   4              return;
1578   4            }
1579   3            g_stop_counter=0;
1580   3            if(g_kid_lock==0)
1581   3            {
1582   4              if(g_work_start==0)
1583   4              {
1584   5                g_operate_counter=0;
1585   5                if(g_key_code==1)
1586   5                {
1587   6                  buzzer(1);
1588   6                  if(g_work_mode!=DIN_WEN_PENG_REN)
1589   6                  {
1590   7                    g_work_mode=DIN_WEN_PENG_REN;
1591   7                    g_peng_ren_shi_chang=g_default_time[g_work_mode];
1592   7                    g_yu_yue_shi_jian=0;
1593   7                    g_yu_yue_ing=0;
1594   7                    g_peng_ren_wen_du=50;
1595   7      
1596   7                  }
1597   6                  else
1598   6                  {
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 27  

1599   7                    if(g_seting_wen_du==1)
1600   7                    {
1601   8                      g_peng_ren_wen_du++;
1602   8                    }           
1603   7                    if(g_peng_ren_wen_du>90)
1604   7                    {
1605   8                      g_peng_ren_wen_du=45;
1606   8                    }
1607   7                    g_seting_wen_du=1;
1608   7                  }
1609   6                  g_dai_P=0;
1610   6                  g_dai_no_P=1;
1611   6                  
1612   6                }
1613   5                else if(g_key_code==2)
1614   5                {
1615   6                  buzzer(1);
1616   6                  g_work_mode=DUN_ROU;
1617   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1618   6                  g_yu_yue_shi_jian=0;
1619   6                  g_yu_yue_ing=0;
1620   6                  g_xiao_peng_ren_shi_jian=0;
1621   6                  g_peng_ren_chang_duan_shi_jian=1;
1622   6                  g_peng_ren_wen_du=165;
1623   6                  g_dai_P=1;
1624   6                  g_dai_no_P=0;
1625   6                }
1626   5                else if(g_key_code==3)
1627   5                {
1628   6                  buzzer(1);
1629   6                  g_work_mode=DUN_TANG;
1630   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1631   6                  g_yu_yue_shi_jian=0;
1632   6                  g_yu_yue_ing=0;
1633   6                  g_xiao_peng_ren_shi_jian=0;
1634   6                  g_peng_ren_chang_duan_shi_jian=1;
1635   6                  g_peng_ren_wen_du=165;
1636   6                  g_dai_P=1;
1637   6                  g_dai_no_P=0;
1638   6                }
1639   5                else if(g_key_code==4)
1640   5                {
1641   6                  buzzer(1);
1642   6                  g_work_mode=LAO_HUO_MAN_DUN;
1643   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1644   6                  g_yu_yue_shi_jian=0;
1645   6                  g_yu_yue_ing=0;
1646   6                  g_peng_ren_wen_du=100;
1647   6                  g_dai_P=0;
1648   6                  g_dai_no_P=0;
1649   6                }
1650   5                else if(g_key_code==5)
1651   5                {
1652   6                  buzzer(1);
1653   6                  g_work_mode=JIAN_KANG_ZHENG;
1654   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1655   6                  g_yu_yue_shi_jian=0;
1656   6                  g_yu_yue_ing=0;
1657   6                  g_xiao_peng_ren_shi_jian=0;
1658   6                  g_peng_ren_chang_duan_shi_jian=1;
1659   6                  g_peng_ren_wen_du=165;
1660   6                  g_dai_P=1;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 28  

1661   6                  g_dai_no_P=0;
1662   6                }
1663   5                else if(g_key_code==6)
1664   5                {
1665   6                  buzzer(1);
1666   6                  g_work_mode=JIAN_CAO;
1667   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1668   6                  g_yu_yue_shi_jian=0;
1669   6                  g_yu_yue_ing=0;
1670   6                  g_peng_ren_wen_du=165;
1671   6                  g_dai_P=1;
1672   6                  g_dai_no_P=0;
1673   6                }
1674   5                else if(g_key_code==12)
1675   5                {
1676   6                  buzzer(1);
1677   6                  g_work_mode=MI_FAN;
1678   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1679   6                  g_yu_yue_shi_jian=0;
1680   6                  g_yu_yue_ing=0;
1681   6                  g_xiao_peng_ren_shi_jian=0;
1682   6                  g_peng_ren_chang_duan_shi_jian=1;
1683   6                  g_peng_ren_wen_du=165;
1684   6                  g_dai_P=1;
1685   6                  g_dai_no_P=0;
1686   6                }
1687   5                else if(g_key_code==11)
1688   5                {
1689   6                  buzzer(1);
1690   6                  g_work_mode=DOU_LEI;
1691   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1692   6                  g_yu_yue_shi_jian=0;
1693   6                  g_yu_yue_ing=0;
1694   6                  g_xiao_peng_ren_shi_jian=0;
1695   6                  g_peng_ren_chang_duan_shi_jian=1;
1696   6                  g_peng_ren_wen_du=165;
1697   6                  g_dai_P=1;
1698   6                  g_dai_no_P=0;
1699   6                }
1700   5                else if(g_key_code==10)
1701   5                {
1702   6                  buzzer(1);
1703   6                  g_work_mode=ZHA_LIANG;
1704   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1705   6                  g_yu_yue_shi_jian=0;
1706   6                  g_yu_yue_ing=0;
1707   6                  g_xiao_peng_ren_shi_jian=0;
1708   6                  g_peng_ren_chang_duan_shi_jian=1;
1709   6                  g_peng_ren_wen_du=165;
1710   6                  g_dai_P=1;
1711   6                  g_dai_no_P=0;
1712   6                }
1713   5                else if(g_key_code==9)
1714   5                {
1715   6                  buzzer(1);
1716   6                  g_work_mode=YAN_MAI;
1717   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1718   6                  g_yu_yue_shi_jian=0;
1719   6                  g_yu_yue_ing=0;
1720   6                  g_peng_ren_wen_du=165;
1721   6                  g_dai_P=0;
1722   6                  g_dai_no_P=0;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 29  

1723   6                }
1724   5                else if(g_key_code==8)
1725   5                {
1726   6                  buzzer(1);
1727   6                  g_work_mode=JI_DAN;
1728   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1729   6                  g_yu_yue_shi_jian=0;
1730   6                  g_yu_yue_ing=0;
1731   6                  g_peng_ren_wen_du=90;
1732   6                  g_dai_P=0;
1733   6                  g_dai_no_P=1;
1734   6                }
1735   5                else if(g_key_code==18)
1736   5                {
1737   6                  buzzer(1);
1738   6                  
1739   6                  if(g_fun_index1==0)
1740   6                  {
1741   7                    g_work_mode=SUAN_NAO;
1742   7                    g_peng_ren_wen_du=40;
1743   7                    g_dai_P=0;
1744   7                    g_dai_no_P=0;
1745   7                  }
1746   6                  else if(g_fun_index1==1)
1747   6                  {
1748   7                    g_work_mode=FA_JIAO;
1749   7                    g_peng_ren_wen_du=40;
1750   7                    g_dai_P=0;
1751   7                    g_dai_no_P=0;
1752   7                  }
1753   6                  else if(g_fun_index1==2)
1754   6                  {
1755   7                    g_work_mode=XIAO_DU;
1756   7                    g_peng_ren_wen_du=165;
1757   7                    g_dai_P=1;
1758   7                    g_dai_no_P=0;
1759   7                  }
1760   6                  
1761   6                  g_fun_index1++;
1762   6                  if(g_fun_index1==3)
1763   6                  {
1764   7                    g_fun_index1=0;
1765   7                  }
1766   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1767   6                  g_yu_yue_shi_jian=0;
1768   6                  g_yu_yue_ing=0;
1769   6                  
1770   6                }
1771   5                else if(g_key_code==19)
1772   5                {
1773   6                  buzzer(1);
1774   6                  if(g_fun_index2==0)
1775   6                  {
1776   7                    g_work_mode=DAN_GAO;
1777   7                    g_peng_ren_wen_du=165;
1778   7                    g_dai_P=1;
1779   7                    g_dai_no_P=0;
1780   7                  }
1781   6                  else if(g_fun_index2==1)
1782   6                  {
1783   7                    g_work_mode=FENG_PEI;
1784   7                    g_peng_ren_wen_du=165;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 30  

1785   7                    g_dai_P=1;
1786   7                    g_dai_no_P=0;
1787   7                  }
1788   6                  else if(g_fun_index2==2)
1789   6                  {
1790   7                    g_work_mode=JI_YA;
1791   7                    g_peng_ren_wen_du=165;
1792   7                    g_dai_P=1;
1793   7                    g_dai_no_P=0;
1794   7                  }
1795   6                  
1796   6                  g_fun_index2++;
1797   6                  if(g_fun_index2==3)
1798   6                  {
1799   7                    g_fun_index2=0;
1800   7                  }
1801   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1802   6                  g_yu_yue_shi_jian=0;
1803   6                  g_yu_yue_ing=0;
1804   6                }
1805   5                else if(g_work_mode==0 && g_key_code==7)
1806   5                {
1807   6                  buzzer(1);
1808   6                  g_work_mode=BAO_WEN;
1809   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
1810   6                  g_yu_yue_shi_jian=0;
1811   6                  g_yu_yue_ing=0;
1812   6                  g_peng_ren_wen_du=60;
1813   6                  g_dai_P=0;
1814   6                  g_dai_no_P=0;
1815   6                  g_operate_counter=2500;
1816   6                  g_working_counter=1500;
1817   6                }
1818   5                else if(g_work_mode!=0 && g_key_code==7)
1819   5                {
1820   6                  buzzer(1);
1821   6                  g_work_mode=STOP;
1822   6                }
1823   5                else if(g_key_code==13)
1824   5                {
1825   6                  buzzer(1);
1826   6                  g_kid_lock=1;
1827   6                }
1828   5                else if(g_key_code==14)
1829   5                { 
1830   6                  buzzer(1);
1831   6                  if(g_yu_yue_shi_jian==0 && 
1832   6                    g_work_mode!=DIN_WEN_PENG_REN &&
1833   6                    g_work_mode!=SUAN_NAO &&
1834   6                    g_work_mode!=FA_JIAO &&
1835   6                    g_work_mode!=BAO_WEN &&
1836   6                    g_work_mode!=JIAN_CAO)
1837   6                  {
1838   7                    g_yu_yue_shi_jian=0;
1839   7                    g_yu_yue_ing=1;
1840   7                  }
1841   6                  else 
1842   6                  {
1843   7                    g_yu_yue_shi_jian=0;
1844   7                    g_yu_yue_ing=0;
1845   7                  }
1846   6                  
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 31  

1847   6                }
1848   5                else if(g_key_code==16 && g_work_mode!=0)
1849   5                {
1850   6                  buzzer(1);
1851   6                  g_seting_wen_du=0;
1852   6                  key_plus();
1853   6                }
1854   5                else if(g_key_code==15 && g_work_mode!=0)
1855   5                {
1856   6                  buzzer(1);
1857   6                  g_seting_wen_du=0;
1858   6                  key_jian();
1859   6                }
1860   5                else if(g_key_code==17)
1861   5                {
1862   6                  g_seting_wen_du=0;
1863   6                  xiao_peng_ren_shi_jian();
1864   6                }
1865   5                if(g_work_mode!=DIN_WEN_PENG_REN)
1866   5                {
1867   6                  g_seting_wen_du=0;
1868   6                }
1869   5                
1870   5              }
1871   4              else 
1872   4              {
1873   5                if(g_key_code==7)
1874   5                {
1875   6                  buzzer(1);
1876   6                  g_work_mode=STOP;
1877   6                }
1878   5                if(g_key_code==13)
1879   5                {
1880   6                  buzzer(1);
1881   6                  g_kid_lock=1;
1882   6                }
1883   5                if(g_key_code==1 && g_work_mode==DIN_WEN_PENG_REN)
1884   5                {
1885   6                  buzzer(1);
1886   6                  g_working_counter=0;
1887   6                }
1888   5              }
1889   4      
1890   4            }
1891   3            if(g_key_code==13)
1892   3            {
1893   4              buzzer(1);
1894   4              g_kid_lock=1;
1895   4            }
1896   3      
1897   3          }
1898   2          
1899   2      
1900   2        }
1901   1        else
1902   1        {
1903   2          key_on=0;
1904   2        }
1905   1      
1906   1      
1907   1        if(g_work_mode!=STOP && g_err_code==0)
1908   1        {
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 32  

1909   2      
1910   2          if(g_operate_counter<2500)
1911   2          {
1912   3            g_operate_counter++;      
1913   3            if(g_operate_counter==1)
1914   3            {
1915   4              show_seting();
1916   4            }
1917   3            else if(g_operate_counter==250)
1918   3            {
1919   4              show_none();
1920   4              g_shi_jian_liang_dian=0;
1921   4            }
1922   3            else if(g_operate_counter==500)
1923   3            {
1924   4              show_seting();
1925   4            }
1926   3            else if(g_operate_counter==750)
1927   3            {
1928   4              show_none();
1929   4              g_shi_jian_liang_dian=0;
1930   4            }
1931   3            else if(g_operate_counter==1000)
1932   3            {
1933   4              show_seting();
1934   4            }
1935   3            else if(g_operate_counter==1250)
1936   3            {
1937   4              show_none();
1938   4              g_shi_jian_liang_dian=0;
1939   4            }
1940   3            else if(g_operate_counter==1500)
1941   3            {
1942   4              show_seting();
1943   4            }
1944   3            else if(g_operate_counter==1750)
1945   3            {
1946   4              show_none();
1947   4              g_shi_jian_liang_dian=0;
1948   4            }
1949   3            else if(g_operate_counter==2000)
1950   3            {
1951   4              show_seting();
1952   4              if(g_yu_yue_shi_jian==0 && g_yu_yue_ing==0)
1953   4              {
1954   5                buzzer(2);
1955   5                g_operate_counter=2500;
1956   5              }
1957   4            }
1958   3            else if(g_operate_counter==2250)
1959   3            {
1960   4              show_none();
1961   4              g_shi_jian_liang_dian=0;
1962   4            }
1963   3            else if(g_operate_counter==2496)
1964   3            {
1965   4              show_seting();
1966   4              buzzer(2);
1967   4            }
1968   3            
1969   3            g_working_counter=1500;
1970   3          }
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 33  

1971   2          else
1972   2          {
1973   3            g_work_start=1;
1974   3            g_yu_yue_ing=0;
1975   3            if(g_working_counter<1500)
1976   3            {
1977   4              g_working_counter++;
1978   4              g_shu_ma_guan[0]='X';
1979   4              g_shu_ma_guan[1]=g_peng_ren_wen_du/10;
1980   4              g_shu_ma_guan[2]=g_peng_ren_wen_du%10;
1981   4              g_shu_ma_guan[3]='C';
1982   4              g_shi_jian_liang_dian=0;
1983   4            }
1984   3            else
1985   3            {   
1986   4              show_none();
1987   4              show_shu_ma_guan_working();
1988   4              show_led();
1989   4      
1990   4            }
1991   3      
1992   3            
1993   3            if(g_yu_yue_shi_jian>0)
1994   3            {
1995   4              RLY=0;
1996   4              g_hoting=0;
1997   4            }
1998   3            else
1999   3            {
2000   4              if(g_peng_ren_shi_chang>0)
2001   4              {
2002   5      
2003   5                if(g_currnet_temp<g_peng_ren_wen_du && KG==0)
2004   5                {
2005   6                  if(g_currnet_temp+5<g_peng_ren_wen_du)
2006   6                  {
2007   7                    RLY=1;
2008   7                    g_hoting=1; 
2009   7                    g_RLY_work_time++;
2010   7                  }           
2011   6                }
2012   5                else
2013   5                {
2014   6                  RLY=0;
2015   6                  g_hoting=0;
2016   6                  g_P_bao_ya_counter_start=1;
2017   6                }
2018   5      
2019   5                if( g_work_mode==DIN_WEN_PENG_REN && g_hoting==1)
2020   5                {
2021   6                  static u32 t_hot=0;
2022   6                  if(g_P_bao_ya_counter_start==1)
2023   6                  {
2024   7                    t_hot+=2;
2025   7                    if(g_peng_ren_wen_du<70)
2026   7                    {
2027   8      
2028   8                      if(t_hot<10000)
2029   8                      {
2030   9      
2031   9                      }
2032   8                      else if(t_hot<20000)
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 34  

2033   8                      {
2034   9                        RLY=0;
2035   9                      }
2036   8                      else
2037   8                      {
2038   9                        t_hot=0;
2039   9                      }
2040   8                    }
2041   7                    else
2042   7                    {
2043   8                      if(t_hot<15000)
2044   8                      {
2045   9      
2046   9                      }
2047   8                      else if(t_hot<25000)
2048   8                      {
2049   9                        RLY=0;
2050   9                      }
2051   8                      else
2052   8                      {
2053   9                        t_hot=0;
2054   9                      }
2055   8                    }
2056   7                    
2057   7                  }
2058   6                }
2059   5                
2060   5              }
2061   4              else
2062   4              {
2063   5                if(g_work_mode!=BAO_WEN)
2064   5                {
2065   6                  g_work_mode=BAO_WEN;
2066   6                  g_peng_ren_shi_chang=g_default_time[g_work_mode];
2067   6                  g_yu_yue_shi_jian=0;
2068   6                  g_peng_ren_wen_du=60;
2069   6                  g_peng_ren_over=1;
2070   6                  buzzer(5);
2071   6                }
2072   5                else
2073   5                {
2074   6                  g_work_mode=STOP;
2075   6                }
2076   5                
2077   5              }
2078   4            }
2079   3      
2080   3          }
2081   2      
2082   2        }
2083   1        else
2084   1        {
2085   2          show_stop();
2086   2          g_peng_ren_shi_chang=0;
2087   2          g_peng_ren_wen_du=0;
2088   2          g_work_start=0;
2089   2          g_yu_yue_shi_jian=0;
2090   2          g_operate_counter=0;
2091   2          g_work_counter=0;
2092   2          RLY=0;
2093   2          g_hoting=0;
2094   2          g_P_bao_ya_counter_start=0;
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 35  

2095   2          g_yu_yue_ing=0;
2096   2          g_fun_index2=0;
2097   2          g_fun_index1=0;
2098   2        }
2099   1      }
2100          void main()
2101          {
2102   1        short tt=0;
2103   1      /************************************ÏµÍ³³õÊ¼»¯****************************************/
2104   1        CLKSWR = 0x51;            //Ñ¡ÔñÄÚ²¿¸ßÆµRCÎªÏµÍ³Ê±ÖÓ£¬ÄÚ²¿¸ßÆµRC 2·ÖÆµ£¬F
             -osc=16MHz
2105   1        CLKDIV = 0x01;            //Fosc 1·ÖÆµµÃµ½Fcpu£¬Fcpu=16MHz 
2106   1      /**********************************UARTÅäÖÃ³õÊ¼»¯**************************************/
2107   1        // init_uart1();
2108   1        init_ntc_adc();
2109   1        init_timer0();
2110   1        init_display();
2111   1        EA = 1;               //Ê¹ÄÜ×ÜÖÐ¶Ï
2112   1          C_RLY = PP_OUTPUT;
2113   1          C_KG =IN_INPUT;
2114   1         
2115   1          show_all();
2116   1          buzzer(2);
2117   1          while(tt++<500)
2118   1          {
2119   2            Delay_ms(2);
2120   2            buzzer(0);
2121   2            display();
2122   2          }
2123   1         
2124   1        while(1)
2125   1        {
2126   2          Delay_ms(2);
2127   2          key_scan();
2128   2          key_operate();
2129   2          display();
2130   2          buzzer(0);
2131   2          check_ya_li_kai_guan();
2132   2          if(tt>100)
2133   2          {
2134   3            get_temp();
2135   3            tt=0;
2136   3          }
2137   2          tt++;
2138   2          
2139   2        }
2140   1      }
2141          /***************************************************************************************
2142            * @ËµÃ÷   T0ÖÐ¶Ï·þÎñº¯Êý  1ms
2143            * @²ÎÊý ÎÞ
2144            * @·µ»ØÖµ ÎÞ
2145            * @×¢   ÎÞ
2146          ***************************************************************************************/
2147          void TIMER0_Rpt(void) interrupt TIMER0_VECTOR
2148          {
2149   1        static unsigned int i=0;  
2150   1        if(g_work_start==1)
2151   1        {
2152   2          if(i++>60000)
2153   2          {
2154   3            i=0;    
2155   3            if(g_yu_yue_shi_jian>0)
C51 COMPILER V9.56.0.0   MAIN                                                              12/26/2020 13:12:13 PAGE 36  

2156   3            {
2157   4              g_yu_yue_shi_jian--;
2158   4            }
2159   3            else
2160   3            {
2161   4              if(g_peng_ren_shi_chang>0)
2162   4              {
2163   5                if(g_dai_P==1 || g_dai_no_P==1)
2164   5                {
2165   6                  if(g_P_bao_ya_counter_start==1)
2166   6                  {
2167   7                    g_peng_ren_shi_chang--;
2168   7                  }
2169   6                }
2170   5                else
2171   5                {
2172   6                  g_peng_ren_shi_chang--;
2173   6                }
2174   5                
2175   5              }
2176   4            }
2177   3          }
2178   2        }
2179   1        else
2180   1        {
2181   2          i=0;
2182   2        }         
2183   1      }
2184          /***************************************************************************************
2185            * @ËµÃ÷   UART1ÖÐ¶Ï·þÎñº¯Êý
2186            * @²ÎÊý ÎÞ
2187            * @·µ»ØÖµ ÎÞ
2188            * @×¢   ÎÞ
2189          ***************************************************************************************/
2190          void UART1_Rpt(void) interrupt UART1_VECTOR
2191          {
2192   1        if(SCON & 0x01)           //ÅÐ¶Ï½ÓÊÕÖÐ¶Ï±êÖ¾Î»
2193   1        {
2194   2        }                 
2195   1      }
2196          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   6963    ----
   CONSTANT SIZE    =    400    ----
   XDATA SIZE       =     67    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     56       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
